\documentclass{article}

\usepackage{fancyhdr}
\usepackage{extramarks}
\usepackage{amsmath,siunitx}
\usepackage{amsthm}
\usepackage{bm}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{multirow}
\usepackage{tikz}
\usepackage[plain]{algorithm}
\usepackage{algpseudocode}
\usepackage{changepage}
\usepackage{mathtools}
\usepackage{parskip}

\usetikzlibrary{automata,positioning}

% 
% Renewal of commands
%
\makeatletter
\renewenvironment{cases}[1][l]{\matrix@check\cases\env@cases{#1}}{\endarray\right.}
\def\env@cases#1{%
  \let\@ifnextchar\new@ifnextchar
  \left\lbrace\def\arraystretch{1.2}%
  \array{@{}#1@{\quad}l@{}}}
\makeatother

%
% Basic Document Settings
%

\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in

\linespread{1.1}

\pagestyle{fancy}
\lhead{\hmwkTeam}
\chead{\hmwkClass: \hmwkTitle}
\rhead{\firstxmark}
\lfoot{\lastxmark}
\cfoot{\thepage}

\renewcommand\headrulewidth{0.4pt}
\renewcommand\footrulewidth{0.4pt}

\setlength\parindent{0pt}

\newcommand{\setsep}{,    \ }

%
% Create Problem Sections
%

\newcommand{\enterProblemHeader}[1]{
    \nobreak\extramarks{}{Problem \hmwkNumber.\arabic{#1} continued on next page\ldots}\nobreak{}
    \nobreak\extramarks{Problem \hmwkNumber.\arabic{#1} (continued)}{Problem \hmwkNumber.\arabic{#1} continued on next page\ldots}\nobreak{}
}

\newcommand{\exitProblemHeader}[1]{
    \nobreak\extramarks{Problem \hmwkNumber.\arabic{#1} (continued)}{Problem \hmwkNumber.\arabic{#1} continued on next page\ldots}\nobreak{}
    \stepcounter{#1}
    \nobreak\extramarks{Problem \hmwkNumber.\arabic{#1}}{}\nobreak{}
}

\setcounter{secnumdepth}{0}
\newcounter{partCounter}
\newcounter{homeworkProblemCounter}
\setcounter{homeworkProblemCounter}{1}
\nobreak\extramarks{Problem \arabic{homeworkProblemCounter}}{}\nobreak{}

%
% Homework Problem Environment
%
% This environment takes an optional argument. When given, it will adjust the
% problem counter. This is useful for when the problems given for your
% assignment aren't sequential. See the last 3 problems of this template for an
% example.
%
\newenvironment{homeworkProblem}[2][-2]{
    \ifnum#1>0
        \setcounter{homeworkProblemCounter}{#1}
    \fi
    \section{Problem \hmwkNumber.\arabic{homeworkProblemCounter} #2}
    \setcounter{partCounter}{1}
    \enterProblemHeader{homeworkProblemCounter}
}{
    \exitProblemHeader{homeworkProblemCounter}
}

%
% Homework Details
%   - Title
%   - Due date
%   - Class
%   - Section/Time
%   - Instructor
%   - Author
%
\newcommand{\hmwkNumber}{H11}
\newcommand{\hmwkTitle}{Homework Assignment \hmwkNumber}
\newcommand{\hmwkClass}{DIC}
\newcommand{\hmwkTeam}{Team \#11}
\newcommand{\hmwkAuthorName}{\hmwkTeam: \\ Camilo MartÃ­nez 7057573, cama00005@stud.uni-saarland.de \\ Honglu Ma 7055053, homa00001@stud.uni-saarland.de \\ Maria Sibi 7058469, mama00047@stud.uni-saarland.de}

%
% Title Page
%

\title{
    % \vspace{2in}
    \textmd{\textbf{\hmwkClass:\ \hmwkTitle}}\\
}

\author{\hmwkAuthorName}
\date \today

\renewcommand{\part}[1]{\textbf{\large Part \Alph{partCounter}}\stepcounter{partCounter}\\}

%
% Various Helper Commands
%

% Useful for algorithms
\newcommand{\alg}[1]{\textsc{\bfseries \footnotesize #1}}

% For derivatives
\newcommand{\deriv}[1]{\frac{\mathrm{d}}{\mathrm{d}x} (#1)}

% For partial derivatives
\newcommand{\pderiv}[2]{\frac{\partial}{\partial #1} (#2)}

% Integral dx
\newcommand{\dx}{\mathrm{d}x}

% Define argmax and argmin
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}

% Declare stat function
\DeclareMathOperator*{\stat}{stat}

% Alias for the Solution section header
\newcommand{\solution}{\textbf{\large Solution}}

% Probability commands: Expectation, Variance, Covariance, Bias
\newcommand{\E}{\mathrm{E}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\Cov}{\mathrm{Cov}}
\newcommand{\Bias}{\mathrm{Bias}}

\begin{document}

\maketitle

\begin{homeworkProblem}{Ellipses as Structuring Elements}

    With $\bm{A} \in \mathbb{R}^{2 \times 2}$ being a symmetric matrix with normalised eigenvectors $\bm{v_1} := (v_{1,1}, v_{1,2})^\top$ and $\bm{v_2} := (-v_{1,2}, v_{1,1})^\top$ in direction of the half-axes $a$ and $b$ of an ellipse, and its eigenvalues given by $\lambda_1 = a^2$ and $\lambda_2 = b^2$, respectively.

    \subsection*{(a)}
    \vspace*{-1.9em}
    \begin{adjustwidth}{2.5em}{0pt}
    Let $\bm{R} := (\bm{v_1} | \bm{v_2})$, then $\bm{A}$ can be eigendecomposed as follows:
    \[
        \bm{A} = a^2 \bm{v_1}\bm{v_1}^\top + b^2 \bm{v_2}\bm{v_2}^\top = \bm{R} \bm{\Lambda} \bm{R}^\top
    \]
    The entries of $\bm{A}$ after performing the mathematical operations are given by:
    \[
        \bm{A} = \begin{pmatrix}
            a^2 v_{1,1}^2 + b^2 v_{1,2}^2 && v_{1,1}v_{1,2}(a^2-b^2) \\ 
            v_{1,1}v_{1,2}(a^2-b^2) && a^2 v_{1,2}^2 + b^2 v_{1,1}^2
        \end{pmatrix}
    \]
    And the determinant is given by:
    \[
        \text{det}(A) = a^2 b^2 (v_{1,1}^2 + v_{1,2}^2)
    \]
    \end{adjustwidth}
    \subsection*{(b)}
    \vspace*{-1.9em}
    \begin{adjustwidth}{2.5em}{0pt}
    Based on the previous derivation of $\bm{A}$ and that by definition $\bm{R}$ is an orthogonal matrix, i.e $\bm{R}^\top = \bm{R}^{-1}$. Thus,
    \[
        \bm{A}^{-1} = (\bm{R} \bm{\Lambda} \bm{R}^\top)^{-1} = (\bm{R}^\top)^{-1} \bm{\Lambda}^{-1} \bm{R}^{-1} = \bm{R} \bm{\Lambda}^{-1} \bm{R}^\top
    \]
    On the other hand, the entries of $\bm{A}^{-1}$ would be given by:
    \[
        \bm{A}^{-1} = \frac{1}{\text{det}(A)} \, \text{adj}(A) = \frac{1}{a^2 b^2 (v_{1,1}^2 + v_{1,2}^2)}\begin{pmatrix}
            a^2 v_{1,2}^2 + b^2 v_{1,1}^2  && v_{1,1}v_{1,2}(b^2 - a^2) \\ 
            v_{1,1}v_{1,2}(b^2 - a^2) && a^2 v_{1,1}^2 + b^2 v_{1,2}^2
        \end{pmatrix}
    \]
    \end{adjustwidth}

    \subsection*{(c)}
    \vspace*{-1.9em}
    \begin{adjustwidth}{2.5em}{0pt}
    Let $\bm{x}(t) = (x_1(t), x_2(t))^\top = \bm{R} \, (a \cos{(t)}, b \sin{(t)})^\top$, then the following derivation follows:
    \begin{align*}
        \bm{x}^\top \bm{A}^{-1} \bm{x} &= (\bm{R} \, (a \cos{(t)}, b \sin{(t)})^\top)^\top \bm{R} \bm{\Lambda}^{-1} \bm{R}^\top (\bm{R} \, (a \cos{(t)}, b \sin{(t)})^\top) \\ 
        &= (a \cos{(t)}, b \sin{(t)}) \bm{R}^\top \bm{R} \bm{\Lambda}^{-1} \bm{R}^\top \bm{R} \, (a \cos{(t)}, b \sin{(t)})^\top \text{, \quad since $(ab^\top)^\top = b a^\top$} \\
        &= (a \cos{(t)}, b \sin{(t)}) \bm{\Lambda}^{-1} (a \cos{(t)}, b \sin{(t)})^\top \text{, \quad since $\bm{R}^\top = \bm{R}^{-1} \rightarrow \bm{R}^\top \bm{R} = \bm{I}$} \\ 
        &= (a \cos{(t)}, b \sin{(t)}) \begin{pmatrix}
            \frac{1}{a^2} & 0 \\
            0 & \frac{1}{b^2}
        \end{pmatrix} (a \cos{(t)}, b \sin{(t)})^\top \\ 
        \intertext{Since the inverse of any diagonal matrix such as $\bm{\Lambda}$ is $1/\lambda_{ii}$ and $0$ when $i \neq j$}
        &= \left(\frac{\cos{(t)}}{a}, \frac{\sin{(t)}}{b}\right) (a \cos{(t)}, b \sin{(t)})^\top \\
        &= \sin^{2}(t) + \cos^{2}(t) = 1 \text{, \quad which is the Pythagorean trigonometric identity}
    \end{align*}
    \end{adjustwidth}

    \subsection*{(d)}
    \vspace*{-1.9em}
    \begin{adjustwidth}{2.5em}{0pt}

    We can set up the following constrained optimization problem with a lagrangian multiplier $\lambda$ like so:
    \begin{equation}\label{H11.1d.first}
        \mathcal{L}(x, \lambda) = \bm{x}^\top \bm{n} + \lambda (1 - \bm{x}
        ^\top \bm{A}^{-1} \bm{x})
    \end{equation}
    Where $\bm{x}^\top \bm{n}$ is our optimization objective and $\bm{x}
    ^\top \bm{A}^{-1} \bm{x} = 1 \rightarrow 1 - \bm{x}
    ^\top \bm{A}^{-1} \bm{x} = 0$ is the constraint.

    Then, we consider $\nabla_x \mathcal{L}(x, \lambda)$ and set it to $0$:
    \begin{equation}\label{H11.1d.second}
        \nabla_x \mathcal{L}(x, \lambda) = \bm{n} - 2\lambda \bm{A}^{-1}\bm{x} = 0 \rightarrow \bm{x} = \frac{1}{2\lambda}\bm{A}\bm{n}
    \end{equation}
    We replace \eqref{H11.1d.second} back on our original constraint:
    \begin{equation}\label{H11.1d.third}
        \begin{split}
            1 &= \bm{x}^\top \bm{A}^{-1} \bm{x} \\ 
            &= \left(\frac{1}{2\lambda}\bm{A}\bm{n}\right)^\top \bm{A}^{-1} \left(\frac{1}{2\lambda}\bm{A}\bm{n}\right) \\
            &= \frac{1}{4\lambda^2}\bm{n}^\top \bm{A}\bm{A}^{-1}\bm{A}\bm{n} \\
            &= \frac{1}{4\lambda^2}\bm{n}^\top \bm{A}\bm{n}
        \end{split}
    \end{equation}
    From \eqref{H11.1d.third}, we can derive an expression for $\lambda$:
    \begin{equation}\label{H11.1d.fourth}
        \lambda = \frac{1}{2}\sqrt{\bm{n}^\top \bm{A} \bm{n}}
    \end{equation}
    We replace \eqref{H11.1d.fourth} back on \eqref{H11.1d.second}. Thus,
    \begin{equation}\label{H11.1d.fifth}
        \bm{x} = \frac{1}{2\lambda}\bm{A}\bm{n} = \frac{1}{2 \left(\frac{1}{2}\sqrt{\bm{n}^\top \bm{A} \bm{n}}\right)}\bm{A}\bm{n} = \frac{\bm{A}\bm{n}}{\sqrt{\bm{n}^\top \bm{A} \bm{n}}}
    \end{equation}
    Finally, we consider our original optimization objective function and use the result on \eqref{H11.1d.fifth} like so:
    \[
        \beta = \adjustlimits\sup_{\bm{x} \in B}(\bm{x}^\top \bm{n}) = \left(\frac{\bm{A}\bm{n}}{\sqrt{\bm{n}^\top \bm{A} \bm{n}}}\right)^\top \bm{n} = \frac{\bm{n}^\top \bm{A} \bm{n}}{\sqrt{\bm{n}^\top \bm{A} \bm{n}}} = \sqrt{\bm{n}^\top \bm{A} \bm{n}}
    \]
    \end{adjustwidth}

    \subsection*{(e)}
    \vspace*{-1.9em}
    \begin{adjustwidth}{2.5em}{0pt}

    \end{adjustwidth}

\end{homeworkProblem}

\begin{homeworkProblem}{Slope Transform and Paraboloids}
    Let $p(\bm{x})$ be a paraboloid of the form 
    \[
        p(\bm{x}) = -\frac{\bm{x}^\top\bm{x}}{4t} \text{, \quad for $\bm{x} \in \mathbb{R}^n, t > 0$}
    \]

    \subsection*{(a)}
    \vspace*{-1.9em}
    \begin{adjustwidth}{2.5em}{0pt}
    For $\bm{v} \in \mathbb{R}^n$, the Slope transform of $p$ is given by
    \[
        S[p](\bm{v}) = \stat\limits_{\bm{x} \in \mathbb{R}^n}{(p(\bm{x}) - \bm{v}^\top \bm{x})} = \left\lbrace p(\bm{x}) - \bm{v}^\top \bm{x} \, | \, \nabla p(\bm{x}) = \bm{v} \right\rbrace
    \] 
    The condition $\nabla p(\bm{x}) = \bm{v}$ entails the following:
    \[
        \nabla p(\bm{x}) = -\frac{\bm{x}}{2t} = \bm{v} \rightarrow \bm{x} = -2t\bm{v}
    \]
    Therefore, the set of $p(\bm{x}) - \bm{v}^\top \bm{x}$ would be given by
    \[
        p(\bm{x}) - \bm{v}^\top \bm{x} = -\frac{(-2t\bm{v})^\top (-2t\bm{v})}{4t} - \bm{v}^\top (-2t\bm{v}) = -t\bm{v}^\top\bm{v} + 2t\bm{v}^\top\bm{v} = t\bm{v}^\top\bm{v} 
    \]
    Which is a paraboloid in $\bm{v}$-space scaled by $t$.
    \end{adjustwidth}

    \subsection*{(b)}
    \vspace*{-1.9em}
    \begin{adjustwidth}{2.5em}{0pt}
    In (max, +)-algebra, the following operations of standard algebra (left) are defined as follows:
    \begin{equation}\label{first}
        x \oplus y = \max\{x, y\},
    \end{equation}
    \begin{equation}\label{second}
        x \otimes y = x + y.
    \end{equation}
    On the other hand, for a 2-D function $p(x, y)$ to be separable in standard algebra, the following condition must be respected: 
    \begin{equation}\label{third}
        p(x, y) = m(x) \otimes n(y)
    \end{equation}
    Where $m$ is only a function of $x$ and $n$ is only a function of $y$.
    
    In (max, +)-algebra, according to \eqref{first}, the condition \eqref{third} would be given by:
    \[
        p(x, y) = m(x) + n(y)
    \]
    Naturally, in 2-D, $p(x, y)$ is given by:
    \[
        p(x, y) = -\frac{x^2}{4t} - \frac{y^2}{4t} = \left(-\frac{x^2}{4t}\right) + \left(-\frac{y^2}{4t}\right)
    \]
    If we pick a function $m(x) = -\frac{x^2}{4t}$, it is easy to see that $p(x, y) = m(x) + m(y)$, thus the separability property holds in (max, +)-algebra.
    \end{adjustwidth}

\end{homeworkProblem}

\end{document}
